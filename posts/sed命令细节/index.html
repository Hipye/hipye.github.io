<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.118.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=google-site-verification content="AsHOUXvrnOA93vxhoMbbXs5tMB7_Hs1_iDtR9d6LYiI"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><link rel=bookmark type=image/x-icon href=images/avatar.png><link rel=icon type=image/x-icon href=images/avatar.png><link rel="shortcut icon" type=image/x-icon href=images/avatar.png><script async src="https://www.googletagmanager.com/gtag/js?id=UA-109916879-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-109916879-1")</script><title>Sed命令细节&nbsp;&ndash;&nbsp;拾集</title><link rel=stylesheet href=/css/core.min.9ff7e9cf576fc82e3a413b6047706e8d3305066d9b901cf82f1dbbca7ed0f88eb4cf96500697f2fc8195eddeb5be64d9.css integrity=sha384-n/fpz1dvyC46QTtgR3BujTMFBm2bkBz4Lx27yn7Q+I60z5ZQBpfy/IGV7d61vmTZ><meta name=twitter:card content="summary"><meta name=twitter:title content="Sed命令细节"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">拾集</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/archives/>归档 </a><a class="nav item" href=/categories/>分类 </a><a class="nav item" href=/tags/>标签</a>
<a class="nav item" href></a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Sed命令细节</h1><p class="article date">2023-09-16
<span class=wordcount>&nbsp;•&nbsp;共&nbsp;1357&nbsp;个字</span><span class=reading-time> • 预计阅读时间 3 分钟</span></p></section><aside id=toc-container class="toc-container wide"><div class=toc><h3>文章目录</h3><div class=inner><ul><li><a href=#%e8%a6%81%e5%a4%84%e7%90%86%e7%9a%84%e5%ad%97%e7%ac%a6%e5%8c%85%e5%90%ab%e5%8d%95%e5%bc%95%e5%8f%b7 aria-label=要处理的字符包含单引号>要处理的字符包含单引号</a></li><li><a href=#%e5%b0%86%e5%88%86%e9%9a%94%e7%ac%a6%e6%8d%a2%e6%88%90%e9%97%ae%e5%8f%b7 aria-label=将分隔符换成问号”?”:>将分隔符换成问号”?”:</a></li><li><a href=#%e6%9b%bf%e6%8d%a2%e6%89%80%e6%9c%89%e5%8c%b9%e9%85%8d%e5%85%b3%e9%94%ae%e5%ad%97 aria-label=替换所有匹配关键字>替换所有匹配关键字</a></li><li><a href=#%e6%b3%a8%e6%84%8f%e8%bf%99%e9%87%8c%e7%9a%84----%e7%ac%a6%e5%8f%b7%e5%a6%82%e6%9e%9c%e6%b2%a1%e6%9c%89-%e5%b0%b1%e4%bc%9a%e7%9b%b4%e6%8e%a5%e5%b0%86%e5%8c%b9%e9%85%8d%e5%88%b0%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%9b%bf%e6%8d%a2%e6%8e%89 aria-label="注意这里的 &amp;quot; &amp;amp; &amp;quot; 符号，如果没有 “&amp;amp;”，就会直接将匹配到的字符串替换掉">注意这里的 " & " 符号，如果没有 “&”，就会直接将匹配到的字符串替换掉</a></li><li><a href=#%e6%9b%bf%e6%8d%a2%e6%96%87%e4%bb%b6%e4%b8%ad%e7%9a%84%e6%89%80%e6%9c%89%e5%8c%b9%e9%85%8d%e9%a1%b9 aria-label=替换文件中的所有匹配项>替换文件中的所有匹配项</a></li><li><a href=#%e5%90%8c%e6%97%b6%e6%89%a7%e8%a1%8c%e4%b8%a4%e4%b8%aa%e6%9b%bf%e6%8d%a2%e8%a7%84%e5%88%99 aria-label=同时执行两个替换规则>同时执行两个替换规则</a></li></ul></div></div></aside><article class="article markdown-body"><div><ol><li>sed替换的基本语法为:</li></ol><p>sed &rsquo;s/原字符串/替换字符串/&rsquo;
单引号里面,s表示替换,三根斜线中间是替换的样式,特殊字符需要使用反斜线”\”进行转义。</p><ol start=2><li>单引号” ‘ ’”是没有办法用反斜线”\”转义的,这时候只要把命令中的单引号改为双引号就行了,格式如下：</li></ol><h1 id=要处理的字符包含单引号>要处理的字符包含单引号</h1><p>sed &ldquo;s/原字符串包含&rsquo;/替换字符串包含&rsquo;/&rdquo;
3. 命令中的三根斜线分隔符可以换成别的符号,有时候替换目录字符串的时候有较多斜线，这个时候换成其它的分割符是较为方便,只需要紧跟s定义即可。</p><h1 id=将分隔符换成问号>将分隔符换成问号”?”:</h1><p>sed &rsquo;s?原字符串?替换字符串?'</p><ol start=4><li>可以在末尾加g替换每一个匹配的关键字,否则只替换每行的第一个,例如:</li></ol><h1 id=替换所有匹配关键字>替换所有匹配关键字</h1><p>sed &rsquo;s/原字符串/替换字符串/g&rsquo;
5. 一些特殊字符的使用</p><p>　　”^”表示行首</p><p>　　”$”符号如果在引号中表示行尾，但是在引号外却表示末行(最后一行)
　　</p><p>复制代码</p><h1 id=注意这里的----符号如果没有-就会直接将匹配到的字符串替换掉>注意这里的 " & " 符号，如果没有 “&”，就会直接将匹配到的字符串替换掉</h1><p>sed &rsquo;s/^/添加的头部&/g&rsquo; 　　　　 #在所有行首添加
sed &rsquo;s/$/&添加的尾部/g&rsquo; 　　　　 #在所有行末添加
sed &lsquo;2s/原字符串/替换字符串/g&rsquo;　 #替换第2行
sed &lsquo;$s/原字符串/替换字符串/g&rsquo; #替换最后一行
sed &lsquo;2,5s/原字符串/替换字符串/g&rsquo; #替换2到5行
sed &lsquo;2,$s/原字符串/替换字符串/g&rsquo; #替换2到最后一行
复制代码</p><p>6.批量替换字符串</p><p>sed -i &ldquo;s/查找字段/替换字段/g&rdquo; <code>grep 查找字段 -rl 路径</code>
sed -i &ldquo;s/oldstring/newstring/g&rdquo; `grep oldstring -rl yourdir</p><ol start=7><li>sed处理过的输出是直接输出到屏幕上的,使用参数”i”直接在文件中替换。</li></ol><h1 id=替换文件中的所有匹配项>替换文件中的所有匹配项</h1><p>sed -i &rsquo;s/原字符串/替换字符串/g&rsquo; filename
8. 多个替换可以在同一条命令中执行,用分号”;”分隔，其格式为:</p><h1 id=同时执行两个替换规则>同时执行两个替换规则</h1><p>sed &rsquo;s/^/添加的头部&/g；s/$/&添加的尾部/g&rsquo;</p><p>sed替换字符串(变量)
sed “s/查找字段/替换字段/g”</p><p>echo helloworld|sed ‘s/hello/world/g’</p><p>sed 替换字符串以变量形式</p><p>1、sed命令使用双引号的情况下，可以使用$var（变量）直接引用：
　　echo | sed &ldquo;s/^/$RANDOM.rmvb_/g&rdquo;
　　13562.rmvb_
　　2、sed命令使用单引号的情况下，可以使用&rsquo;"$var"&lsquo;引用（单引号，然后双引号，变量）：
　　echo | sed &rsquo;s/^/&rsquo;"$RANDOM"&rsquo;.rmvb_/g&rsquo;
　　2442.rmvb_
　　sed中执行外部命令。
　　1、sed命令使用单引号的情况下使用&rsquo;<code>shell command</code>&lsquo;或者&rsquo;$(shell command)&lsquo;引用命令执行的结果：
　　echo | sed &rsquo;s/^/&rsquo;<code>echo $RANDOM</code>&rsquo;.rmvb_/g&rsquo;
　　7700.rmvb_# 结果
　　# 上面的命令使用了旧式的命令替换，也可以采用新式的命令替换方法，如下：
　　echo | sed &rsquo;s/^/&rsquo;$(echo $RANDOM)&rsquo;.rmvb_/g&rsquo;
　　13856.rmvb_# 结果
　　# 下面例子取用当前日期作为结果的一部分，如下：
　　echo | sed &rsquo;s/^/&rsquo;$(date +"%Y%m%d")&rsquo;.rmvb_/g&rsquo;
　　20130401.rmvb_ # 结果
　　2、sed命令中使用双引号的情况下，直接<code>shell command</code>或者$(shell command)引用命令执行。
　　echo | sed &ldquo;s/^/$(date +"%Y%m%d&rdquo;).rmvb_/g"
　　20130401.rmvb_# 结果
　　# 使用环境变量$RANDOM以及旧式命令替换的例子：
　　echo | sed &ldquo;s/^/<code>echo $RANDOM</code>.rmvb_/g&rdquo;</p></div></article><section class="article labels"><a class=category href=/categories/></a><a class=tag href=/tags/></a></section></div><div class="article bottom"><div class="article bottom title">更多文章</div><section class="article navigation"><p><a class=link href=/posts/bashrc%E5%92%8Cvimrc%E9%85%8D%E7%BD%AE%E4%BB%A5%E5%8F%8A%E8%AF%A6%E7%BB%86/><span class="iconfont icon-article"></span>bashrc和vimec配置以及详细</a></p></section><section class="article discussion"><script src=https://utteranc.es/client.js repo=Hipye/morris issue-term=pathname label theme=github-light crossorigin=anonymous async></script></section><div class=nav-bottom><div class="nav wrap bottom"><nav class=nav><a class="nav item" href=/archives/>归档 </a><a class="nav item" href=/categories/>分类 </a><a class="nav item" href=/tags/>标签</a></nav></div></div></div></section><section id=footer><div class=tongji style=text-align:center><span>共 25 篇文章 • 总计 19174 字</span></div><div class=footer-wrap><p class=copyright>©2019 Moriz.</p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank rel="noopener noreferrer">Notepadium</a></p></div></section><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script src=/js/hljs.min.6f979583f61e4ec5f0b94f94eab2e130ee628032474d374414dba4e33cc12097a0d01fe65b33378b23f6d3b053b95445.js integrity=sha384-b5eVg/YeTsXwuU+U6rLhMO5igDJHTTdEFNuk4zzBIJeg0B/mWzM3iyP207BTuVRF></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/core.min.5c7b67437ff4e36acca5d4f8fd7094276f09573657d699a765d6ad6b40a7c4e00993c7f07cb6637e726ae7c3f77fc968.js integrity=sha384-XHtnQ3/042rMpdT4/XCUJ28JVzZX1pmnZdata0CnxOAJk8fwfLZjfnJq58P3f8lo></script>
<script src=https://cdn.jsdelivr.net/npm/echarts@5.3.0/dist/echarts.min.js></script>
<script type=text/javascript>var myChart=echarts.init(document.getElementById("heatmap")),option,data,rangeArr,listeners;window.onresize=function(){myChart.resize()};function heatmap_width(e){var t=new Date,o=t.setMonth(t.getMonth()-e),n=+new Date,t=+new Date(o),n=echarts.format.formatTime("yyyy-MM-dd",n),t=echarts.format.formatTime("yyyy-MM-dd",t),s=[];return s.push([t,n]),s}data=[],data.push(["2023-09-16",1357]),data.push(["2023-09-09",2371]),data.push(["2023-09-06",618]),data.push(["2023-04-16",191]),data.push(["2023-03-14",6]),data.push(["2023-03-14",16]),data.push(["2023-03-14",417]),data.push(["2023-03-14",127]),data.push(["2023-03-09",216]),data.push(["2023-03-02",569]),data.push(["2023-02-25",106]),data.push(["2023-02-25",665]),data.push(["2023-02-19",78]),data.push(["0001-01-01",1019]),data.push(["2022-12-02",552]),data.push(["2022-11-23",247]),data.push(["2022-11-23",1765]),data.push(["2022-11-20",223]),data.push(["2022-11-20",322]),data.push(["2022-11-18",620]),data.push(["2022-11-11",704]),data.push(["2022-11-11",1050]),data.push(["2022-11-11",1225]),data.push(["2022-11-11",4311]),data.push(["2022-11-11",250]),data.push(["2019-05-28",0]),data.push(["2019-02-28",149]),data.push(["0001-01-01",0]),window.matchMedia("(max-width: 320px)").matches?(rangeArr=heatmap_width(3)):window.matchMedia("(max-width: 400px)").matches?(rangeArr=heatmap_width(5)):window.matchMedia("(max-width: 550px)").matches?(rangeArr=heatmap_width(6)):window.matchMedia("(max-width: 1021px)").matches?(rangeArr=heatmap_width(12)):window.matchMedia("(max-width: 1400px)").matches?(rangeArr=heatmap_width(9)):window.matchMedia("(max-width: 1920px)").matches?(rangeArr=heatmap_width(12)):window.matchMedia("(max-width: 2560px)").matches&&(rangeArr=heatmap_width(24));function LightOption(){option={title:{show:!0,top:0,left:20,text:"文章热力图",textStyle:{color:"rgba(29,43,76,.85)",fontSize:10}},tooltip:{padding:10,backgroundColor:"#777",borderColor:"#777",borderWidth:1,formatter:function(e){var t=e.value;return'<div style="font-size: 14px;color: white;">'+t[0]+": "+t[1]+"</div>"}},visualMap:{show:!1,top:0,min:0,max:5e3,textStyle:{color:"#7bc96f",fontWeight:"bold",fontFamily:"monospace"},calculable:!0,inRange:{symbol:"rect",color:["#ccffcc","#82c979","#43923c","#125b15","#002800"]},itemWidth:12,itemHeight:200,orient:"horizontal",right:0},calendar:{top:45,left:30,right:30,cellSize:[12,12],orient:"horizontal",range:rangeArr,splitLine:{show:!1,lineStyle:{width:.5,type:"solid",color:"white"}},itemStyle:{borderWidth:3.4,borderType:"solid",shadowColor:"#f3f6f9",shadowBlur:1.2,borderColor:"#f3f6f9",color:"#dddddd",opacity:1},yearLabel:{show:!0,position:"top",fontWeight:"normal",fontSize:12,color:"#24292e"},monthLabel:{nameMap:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fontWeight:"bolder",color:"#24292e",fontSize:8},dayLabel:{formatter:"{start}  1st",fontWeight:"bolder",nameMap:["","Mon","","Wed","","Fri",""],color:"#24292e",fontSize:8}},series:{type:"heatmap",coordinateSystem:"calendar",data}},option&&myChart.setOption(option)}function DarkOption(){option={title:{show:!0,top:0,left:20,text:"文章热力图",textStyle:{color:"#c7d5f6",fontSize:10}},tooltip:{padding:10,backgroundColor:"#777",borderColor:"#777",borderWidth:1,formatter:function(e){var t=e.value;return'<div style="font-size: 14px;color: white;">'+t[0]+": "+t[1]+"</div>"}},visualMap:{show:!1,top:0,min:0,max:5e3,textStyle:{color:"#c7d5f6",fontWeight:"bold",fontFamily:"monospace"},calculable:!0,inRange:{symbol:"rect",color:["#ccffcc","#82c979","#43923c","#125b15","#002800"],opacity:.8},itemWidth:12,itemHeight:200,orient:"horizontal",right:0},calendar:{top:45,left:30,right:30,cellSize:[12,12],orient:"horizontal",range:rangeArr,splitLine:{show:!1,lineStyle:{width:.5,type:"solid",color:"white"}},itemStyle:{borderWidth:3.4,borderType:"solid",shadowColor:"#0d1117",shadowBlur:1.2,borderColor:"#0d1117",color:"#24292e",opacity:1},yearLabel:{show:!0,position:"top",fontWeight:"normal",fontSize:12,color:"#c7d5f6"},monthLabel:{nameMap:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fontWeight:"bolder",color:"#c7d5f6",fontSize:8},dayLabel:{formatter:"{start}  1st",fontWeight:"bolder",nameMap:["","Mon","","Wed","","Fri",""],color:"#c7d5f6",fontSize:8}},series:{type:"heatmap",coordinateSystem:"calendar",data}},option&&myChart.setOption(option)}window.matchMedia("(prefers-color-scheme: dark)").matches?DarkOption():LightOption(),listeners={dark:e=>{e.matches&&DarkOption()},light:e=>{e.matches&&LightOption()}},window.matchMedia("(prefers-color-scheme: dark)").addListener(listeners.dark),window.matchMedia("(prefers-color-scheme: light)").addListener(listeners.light)</script></body></html>